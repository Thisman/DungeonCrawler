# Game Design Overview

## 1. Базовая информация о продукте
**Жанр:** 2D dungeon crawler с тактическими пошаговыми боями и элементами roguelite (реиграбельные забеги + мета-прогрессия).

**Платформа:** PC.

**Игровой формат:** Одиночная игра (singleplayer).

**Ключевые цели:**
- Дать ощущение исследования опасного лабиринта с неожиданностями и тайнами.
- Сделать глубокую, но понятную пошаговую боёвку с отрядами.
- Обеспечить реиграбельность за счёт вариативности забегов, билдов героя и случайных событий.
- Заложить фундамент для мета-прогрессии и расширения контента без переписывания ядра.

## 2. Основной игровой цикл (core loop)
### 2.1. Высокоуровневый цикл забега
- Игрок начинает забег в лабиринте.
- Исследует комнаты и коридоры:
  - сталкивается с врагами,
  - находит предметы и ресурсы,
  - триггерит события, диалоги, загадки, потайные ходы,
  - выполняет побочные квесты.
- Вступает в бои с вражескими отрядами.
- Получает награды (ресурсы, предметы, улучшения, прогресс по квестам).
- Пытается добраться до выхода с уровня/этажа.
- При выходе:
  - тратятся ресурсы на сопровождение армии,
  - при недостатке ресурсов — часть отрядов жертвуется.
- Загрузка следующего случайного уровня.
- После прохождения всех уровней забега или смерти — завершение забега:
  - часть информации (квесты и мета-состояния) может сохраняться между забегами.

### 2.2. Цикл уровня лабиринта
- Для каждого уровня:
  - Исследование: перемещение между комнатами/коридорами.
  - Взаимодействие с объектами:
    - враги → бои,
    - сундуки → лут,
    - NPC → диалоги, квесты, магазины,
    - загадки → награды/доступ к тайным зонам,
    - выход уровня → переход к следующему.

## 3. Боевая система
### 3.1. Общая модель боя
- Формат: пошаговый тактический бой.
- Поле боя: статичная сетка:
  - до 6 слотов на стороне игрока,
  - до 6 слотов на стороне врага.
- Юниты не перемещаются по сетке во время боя (позиции фиксированы).
- Структура:
  - Юнит → элемент отряда.
  - Отряд → набор до 6 юнитов, привязанных к слотам сетки.
- У игрока:
  - герой (отряд из одного юнита),
  - дополнительные отряды.
- У врагов: отряды юнитов.

### 3.2. Ход боя
- Бой идёт раундами.
- В рамках раунда юниты ходят по очереди (детали порядка — через параметры игры).
- В свой ход юнит совершает одно действие:
  - использовать активную способность,
  - совершить обычную атаку,
  - защититься,
  - пропустить ход и т.п.
- Условия окончания боя:
  - победа: вражеский отряд уничтожен,
  - поражение: армия игрока или герой уничтожены (детали – по дизайну).

### 3.3. Способности и эффекты
- Способности:
  - Активные и пассивные.
  - Могут:
    - наносить урон,
    - лечить,
    - накладывать баффы/дебаффы,
    - накладывать/снимать эффекты,
    - взаимодействовать с ресурсами, щитами и т.п.
  - Каждая активная способность имеет:
    - кулдаун,
    - цели (одна цель, несколько целей, отряд и т.д.),
    - условия срабатывания/доступности (уровень, теги и т.п.).
- Эффекты:
  - Баффы и дебаффы:
    - изменение статов,
    - DoT/HoT,
    - щиты, сопротивления, уязвимости и т.п.
  - Могут быть:
    - временными (с длительностью),
    - постоянными (до конца боя или до снятия).
  - Длительность и кулдауны могут обновляться:
    - в начале раунда,
    - в начале хода юнита,
    - при использовании способности,
    - при получении урона,
    - при наступлении других боевых событий.

## 4. Прогрессия и улучшения
### 4.1. Прогрессия юнитов
- Все юниты получают опыт за бой.
- При достижении порога XP юнит автоматически повышает уровень.
- Левел-ап:
  - по формуле растут характеристики (HP, урон, защита и т.п.).
  - формула едина или задаётся параметрами (data-driven).

### 4.2. Прогрессия героя
- Герой — особый юнит:
  - при повышении уровня герой получает выбор улучшений.
- Улучшения:
  - выбираются игроком из набора, сгенерированного случайным образом.
  - могут распространяться:
    - только на героя,
    - на его отряд,
    - на другие отряды игрока (в зависимости от дизайна улучшения).
  - типы улучшений:
    - рост статов,
    - улучшение существующих способностей,
    - получение новых способностей,
    - получение предметов (дающих эффекты или способности),
    - изменения правил взаимодействия (синергии, триггеры и т.п.).

### 4.3. Генерация улучшений
- Набор улучшений генерируется случайно с учётом:
  - текущего уровня героя,
  - состава армии/отрядов,
  - контекста забега (возможно),
  - редкости/весов самих улучшений.
- Одни улучшения попадаются чаще, другие реже (система редкости).

## 5. Лабиринт и структура уровней
### 5.1. Структура подземелья
- Лабиринт состоит из:
  - комнат,
  - коридоров,
  - потайных ходов,
  - скрытых комнат.
- На MVP:
  - уровни собираются вручную (ручной лейаут с возможностью дальнейшей замены на процедурную генерацию).

### 5.2. Контент комнат
- В комнатах и коридорах могут находиться:
  - Вражеские отряды.
  - Интерактивные предметы (сундуки, алтари, рычаги, ловушки и т.п.).
  - NPC (торговцы, квестодатели, сюжетные персонажи).
  - Событийные триггеры (случайные события, кат-сцены).
  - Загадки/пазлы.
  - Выходы на следующий уровень.

## 6. Ресурсы и экономика
### 6.1. Ресурсы
- Есть общие ресурсы (валюта/материалы), которые:
  - собираются на уровне (лук, сундуки, награда за бой),
  - тратятся при выходе с уровня.

### 6.2. Стоимость выхода с уровня
- При выходе с текущего уровня:
  - затрачивается определённое количество ресурсов,
  - стоимость зависит от состава армии игрока (количество/тип юнитов и/или отрядов).
- Если ресурсов не хватает:
  - игрок вынужден жертвовать отрядами (часть армии остаётся позади/гибнет).

### 6.3. Предметы
- На карте можно находить предметы.
- Предметы:
  - накладывают эффекты (пассивные),
  - или дают дополнительные активные способности.
- Предметы могут выступать в роли:
  - части наград (сундуки, боссы),
  - части улучшений (как опция в системе перков).

## 7. Системы и контент, запланированные на продукт
### 7.1. Способности и эффекты
- Пассивные и активные способности.
- Временные и постоянные эффекты.
- Стек эффектов, взаимодействие и возможные синергии (в полной версии).

### 7.2. Улучшения (перки)
- Различные типы улучшений героя и отрядов.
- Редкость/вес выпадения.
- Возможность генерировать “билды” героя.

### 7.3. Инвентарь
- Система хранения и использования предметов.
- Базово — список предметов (без сложной экипировки; может быть расширено позже).

### 7.4. Боссы и особые встречи
- Отдельные бои с боссами:
  - усиленные противники,
  - особые механики.
- Награды за убийство босса:
  - редкие предметы,
  - существенные ресурсы,
  - ключевые улучшения.

### 7.5. Магазины и NPC
- Магазины:
  - продажа/покупка предметов и, возможно, услуг (лечение, снятие эффектов и т.д.).
- NPC:
  - квесты,
  - диалоги,
  - сюжетные ивенты.

### 7.6. События и квесты
- Случайные события в лабиринте (ивенты с выбором и исходами).
- Квесты:
  - однозабежные и многоэтапные, выполняемые за несколько забегов.
- Награды:
  - ресурсы,
  - предметы,
  - улучшения,
  - изменения мира/лабиринта.

### 7.7. Диалоги и кат-сцены
- Диалоги:
  - с NPC, перед боями, после боёв, в ключевых точках.
- Кат-сцены:
  - базовые сценки (камера, реплики, анимации) для сюжетных моментов.

## 8. Мета-прогрессия
- Между забегами может сохраниться часть информации о выполнении квестов:
  - некоторые квесты требуют нескольких забегов для завершения,
  - состояние таких квестов не должно обнуляться при смерти/завершении забега.
- Дальнейшее расширение мета-прогрессии:
  - глобальные разблокировки,
  - постоянные бонусы,
  - изменения стартовых условий забега — планируется, но не обязательно на первый MVP.
